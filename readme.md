# RPG数值系统模拟器 - 游戏策划专用数值测试工具

这是一款为游戏策划量身定制的RPG数值系统模拟与分析工具，核心价值在于帮助策划团队无需等待程序实现，就能快速验证、平衡和优化游戏中的数值体系，显著减少试错成本，提升游戏整体平衡性。

## 项目概述

在游戏开发过程中，数值平衡是一项既关键又耗时的工作。本工具的诞生正是为了解决策划团队在数值设计中面临的核心痛点：传统开发流程中，策划需要等待程序实现后才能验证数值设计效果，这常常导致反复修改和时间浪费。

通过本模拟器，策划可以直接在程序实现前测试各种数值方案，直观观察不同属性搭配和成长模型的效果，快速迭代找到最佳平衡方案。同时，工具还提供了丰富的数据可视化和分析功能，帮助策划更科学地做出数值决策。

## 系统架构与可扩展性

项目采用高度模块化的设计理念，代码结构清晰，便于技术人员进行二次开发和功能扩展。整个系统由几个核心模块组成，每个模块职责明确，耦合度低，这使得修改或扩展任何部分都不会影响其他功能的正常运行。

核心目录结构包括：
- **core/**: 包含角色基础类和伤害计算等核心逻辑
- **data/**: 负责数据处理和XML持久化操作
- **logic/**: 实现角色管理和战斗模拟等业务逻辑
- **utils/**: 提供属性计算、成长曲线算法和图表生成等工具函数
- **ui/**: 构建用户交互界面
- **main/**: 程序入口和主流程控制

特别值得一提的是，战斗逻辑和成长曲线系统被设计为高度可扩展的组件。开发人员可以轻松添加新的战斗机制或成长模型，而无需大幅修改现有代码，这为项目的持续演进提供了极大便利。

## 核心功能

### 属性系统配置
属性系统设计得非常灵活，策划可以通过简单的XML配置文件轻松定义和管理游戏中的所有属性。系统支持设置属性的显示名称、默认值、数值范围和详细描述，无需修改代码就能适应不同游戏的需求。这种设计使得添加新属性或修改现有属性变得异常简单，为游戏数值体系的迭代提供了便利。

### 成长曲线模拟
成长曲线是本工具的一大亮点，提供了丰富多样的数学模型供策划选择。目前系统内置了线性、指数、对数、幂函数、S形和混合等多种成长曲线，每种曲线都可以通过参数调整来获得不同的效果。更重要的是，成长曲线系统采用了可插拔设计，技术人员可以轻松添加自定义的成长公式。

在utils/growth_curve.py文件中，每个成长曲线都是一个独立的函数，遵循统一的接口定义。要添加新的成长模型，只需按照相同的模式编写新函数并在主程序中注册即可，整个过程简单明了，无需修改核心架构。

### 伤害公式验证
伤害计算系统同样具备高度的可扩展性。当前的实现支持基础伤害计算、暴击机制和等级差异调整等功能，但这些都可以根据游戏需求轻松扩展。

在core/damage.py文件中，calculate_damage函数封装了核心的伤害计算逻辑。开发人员可以通过修改这个函数或添加新的计算模块，来实现更复杂的伤害机制，如元素伤害、连击系统、属性相克等。整个系统的设计使得伤害公式可以自由演化，从简单到复杂都能轻松应对。

### 战斗数据模拟
战斗模拟系统可以进行单次战斗或批量战斗分析，帮助策划验证数值平衡性。系统会自动记录战斗结果，计算平均伤害、暴击率等关键指标，并生成详细的统计数据。通过批量模拟，策划可以快速发现潜在的数值异常，确保游戏体验的稳定性。

战斗逻辑同样设计为可扩展的模块，技术人员可以在logic/battle.py中添加新的战斗机制，如回合制战斗、实时战斗、技能系统等，而不会影响到其他功能的正常运行。

### 数据可视化与分析
为了帮助策划更好地理解数值关系，系统提供了强大的数据可视化功能。通过生成属性成长曲线图表和战斗数据统计，策划可以直观地观察不同参数设置的效果。所有数据都可以导出为CSV格式，便于进一步的深入分析或整合到策划文档中。

### 角色批量生成
为了提高测试效率，系统支持快速生成测试角色。策划可以手动创建特定属性的角色，也可以批量生成随机角色用于压力测试。这些功能大大缩短了测试准备时间，让策划能够更专注于数值设计本身。

## 快速开始

要开始使用这个工具非常简单。首先确保你的电脑上安装了Python 3.7或更高版本（无需编程知识，仅需安装环境），然后在项目目录下安装必要的依赖包。运行以下命令：

```bash
pip install -r requirements.txt
```

安装完成后，首次运行时系统会自动创建默认的属性配置文件。直接在命令行中输入以下命令启动程序：

```bash
python run.py
```

启动后将看到交互式菜单，你可以通过输入对应的数字来选择不同的功能模块。整个操作流程设计得非常直观，即使是不熟悉编程的策划人员也能轻松上手。

## 使用指南

### 角色管理

在进行数值测试前，你需要准备测试用的角色。系统提供了多种角色创建方式：可以手动添加特定属性的测试角色，快速批量生成多个不同配置的角色用于对比测试，或者创建具有随机属性的角色进行压力测试。每个角色创建后都可以查看其详细配置和属性信息，确保测试用例的准确性。

### 战斗模拟

战斗模拟是验证数值平衡性的核心功能。你可以选择两个角色进行快速对战测试，或者执行批量战斗模拟（推荐1000次以上）来获得统计数据。在模拟过程中，你可以灵活调整暴击倍数、伤害系数等关键参数，观察它们对战斗结果的影响。系统会自动统计平均伤害、暴击率、胜率等关键指标，帮助你发现潜在的数值不平衡问题。

### 属性分析

属性分析功能允许你直观验证成长曲线的设计效果。通过成长曲线预览，你可以清晰地看到角色属性随等级的变化趋势；多曲线对比功能让你能够同时观察不同成长模型的效果差异；等级范围测试可以帮助你聚焦于特定等级段的属性变化；属性敏感性分析则可以测试不同属性对战斗结果的实际影响权重，为数值平衡提供数据支持。

## 策划使用指南

### 属性配置文件（策划工作流）

`attributes_config.xml` 是策划配置游戏属性体系的核心文件：
- **显示名称**：游戏中向玩家展示的属性名
- **属性范围**：设置合理的最小值和最大值
- **属性说明**：记录属性的游戏内意义和影响

### 角色数据管理

`characters.xml` 可保存多个测试角色配置：
- **预设角色**：保存标准测试角色用于对比
- **导出分享**：可在策划团队间共享测试用例

### 策划工作流程建议

1. **需求定义**：明确游戏的核心数值体系目标
2. **基础配置**：设置属性和成长曲线
3. **原型测试**：创建测试角色并进行初步模拟
4. **参数调整**：修改关键参数并观察效果
5. **批量验证**：进行大量模拟验证平衡性
6. **数据分析**：使用生成的图表和数据支持决策
7. **文档输出**：将验证后的数值整理成正式文档

## 代码可扩展性详解

本项目的一个核心设计理念就是高度的可扩展性，特别是在战斗逻辑和成长曲线这两个关键模块上。下面详细介绍如何对系统进行二次开发和扩展：

### 成长曲线系统扩展

成长曲线系统采用了简单直观的函数式设计。在utils/growth_curve.py文件中，每个成长曲线都是一个独立的函数，遵循统一的接口定义：

```python
def 曲线函数名(base_value, growth_factor, level, max_level):
    # 计算逻辑
    return 计算结果
```

要添加新的成长模型，只需按照这个模式编写新函数，然后在需要使用的地方调用它即可。这种设计使得扩展变得异常简单，无需修改核心架构。系统已经内置了多种常见的成长曲线，但你可以轻松添加符合特定游戏设计需求的自定义曲线。

### 战斗逻辑扩展

战斗逻辑同样设计为可扩展的模块。在logic/battle.py文件中，battle_between_characters和fight_to_the_death函数实现了基本的战斗流程，但这些函数可以作为基础进行扩展。

如果你想添加新的战斗机制，如技能系统、状态效果或特殊战斗规则，只需在现有函数的基础上进行扩展，或者创建新的战斗模式函数。整个系统的设计确保了不同战斗机制之间的兼容性，让你可以灵活组合各种功能。

### 属性系统扩展

属性系统同样支持灵活扩展。除了通过XML配置文件添加基本属性外，你还可以在core/character.py中的Character类中实现派生属性。通过定义getter方法，你可以创建计算型属性，如暴击率、命中率等，这些属性的值会根据其他基础属性动态计算。

### 数据处理扩展

数据处理模块提供了XML文件的读写功能，但你可以根据需要扩展支持其他格式。在data/xml_handler.py文件中，处理逻辑与具体的文件格式紧密相关，但整个模块的接口设计允许轻松替换或扩展数据处理方式。

## 输出成果（策划文档支持）

系统会在 `output_charts/` 目录下生成可直接用于策划文档的文件：
- **属性数据CSV**：包含详细数值，可导入Excel进行进一步分析
- **成长曲线PNG**：直观的可视化图表，可直接插入策划文档

## 二次开发最佳实践

对于想要对系统进行二次开发的技术人员，这里有一些建议：

1. 在添加新功能之前，先理解现有代码的结构和设计意图。项目采用了模块化设计，各个组件之间的耦合度较低，这为扩展提供了便利。

2. 当添加新的成长曲线或战斗机制时，尽量遵循现有的接口规范，这样可以确保新功能与系统的其他部分无缝集成。

3. 对于数值相关的修改，建议进行全面的测试，确保修改不会导致意外的数值异常。系统本身的模拟功能可以帮助你验证修改的效果。

4. 代码中已经包含了详细的注释，这些注释可以帮助你理解各个函数和类的作用。如果添加新功能，也请保持良好的注释习惯，便于团队其他成员理解。

## 总结

本工具为游戏策划提供了一个强大而灵活的数值测试环境，使得数值设计工作变得更加高效和科学。同时，系统的可扩展设计也为技术团队提供了便利，使得根据项目需求进行定制开发变得简单可行。

无论你是需要快速验证一个简单的伤害公式，还是构建复杂的成长模型和战斗系统，这个工具都能满足你的需求。通过这个模拟器，你可以在游戏正式开发前就对数值系统有清晰的认识，大大降低后续开发中的调整成本，提高游戏的整体品质。

## License

MIT License